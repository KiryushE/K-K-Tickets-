{% extends 'base.html' %}
{% load static %}

{% block title %}–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –º—ñ—Å—Ü—å ‚Äî {{ concert.title }}{% endblock %}

{% block content %}
<div class="container my-5" style="padding-top: 80px;">
  <div class="card shadow-sm border-0">
    <div class="row g-0">
      <div class="col-md-5">
        <img src="{{ concert.image_url }}" class="img-fluid rounded-start w-100 h-100 object-fit-cover" alt="–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è –∫–æ–Ω—Ü–µ—Ä—Ç—É {{ concert.title }}">
      </div>
      <div class="col-md-7">
        <div class="card-body">
          <h2 class="card-title mb-3">–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –º—ñ—Å—Ü—å –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç: <br>{{ concert.title }}</h2>
          <h5 class="text-muted mb-3">üë§ {{ concert.performer }}</h5>
          <p class="mb-2"><i class="bi bi-calendar-event"></i> <strong>{{ concert.date|date:"d M Y H:i" }}</strong></p>
          <p class="mb-2"><i class="bi bi-geo-alt"></i> {{ concert.location }}</p>
          <hr>

          <form method="post" id="bookingForm" class="mt-4">
            {% csrf_token %}
            <div class="seats-container text-center">
              {% for row_val in rows %}
                <div class="seat-row d-flex justify-content-center mb-2">
                  {% for seat_val in seats %}
                    <label for="seat-{{ row_val }}-{{ seat_val }}">
                      <input
                        type="checkbox"
                        id="seat-{{ row_val }}-{{ seat_val }}"
                        name="seats"
                        value="{{ row_val }}-{{ seat_val }}"
                        class="seat-checkbox"
                        style="display: none;"
                      />
                      {% if row_val|stringformat:"s"|add:"-"|add:seat_val|stringformat:"s" in user_seats %}
                        <img src="{% static 'img/yours.jpg' %}" class="seat" title="–í–∞—à–µ –º—ñ—Å—Ü–µ" />
                      {% elif row_val|stringformat:"s"|add:"-"|add:seat_val|stringformat:"s" in taken_seats %}
                        <img src="{% static 'img/taken.jpg' %}" class="seat" title="–ó–∞–Ω—è—Ç–æ" />
                      {% else %}
                        <img src="{% static 'img/free.jpg' %}" class="seat" title="–í—ñ–ª—å–Ω–æ" />
                      {% endif %}
                    </label>
                  {% endfor %}
                </div>
              {% endfor %}
            </div>

            <div class="d-flex justify-content-between align-items-center mt-4">
              <a href="{% url 'concert_list' %}" class="btn btn-secondary">
                <i class="bi bi-arrow-left me-1"></i> –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è
              </a>
              <button type="submit" class="btn" style="background-color: #2f384f; color: white;">
                <i class="bi bi-ticket-fill me-1"></i> –ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏ –æ–±—Ä–∞–Ω—ñ –º—ñ—Å—Ü—è
              </button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .seat {
    width: 30px;
    height: 30px;
    margin-right: 5px;
    cursor: pointer;
  }
  .seat-row {
    justify-content: center;
  }
  .seats-container {
      margin-top: 20px;
  }
  .seat-checkbox {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }
</style>
{% endblock %}